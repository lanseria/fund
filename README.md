# Fund Investment Assistant (åŸºé‡‘æŠ•èµ„åŠ©æ‰‹)

ä¸€ä¸ªåŸºäº Python çš„åŸºé‡‘æŠ•èµ„åŠ©æ‰‹åå°æœåŠ¡ï¼Œæä¾› API å’Œ CLI ä¸¤ç§äº¤äº’æ–¹å¼ï¼Œå¸®åŠ©ç”¨æˆ·ç®¡ç†å’Œåˆ†æå…¶æŒæœ‰çš„åŸºé‡‘ã€‚

è¯¥é¡¹ç›®ä½¿ç”¨ç°ä»£ Python æŠ€æœ¯æ ˆæ„å»ºï¼ŒåŒ…æ‹¬ FastAPI, Typer, SQLAlchemy, å’Œ uvï¼Œå¹¶éµå¾ªæ¸…æ™°çš„åˆ†å±‚æ¶æ„è®¾è®¡ã€‚

## âœ¨ ä¸»è¦åŠŸèƒ½

-   **æŒä»“ç®¡ç†**: é€šè¿‡ API æˆ–å‘½ä»¤è¡Œ (CLI) æ·»åŠ ã€æŸ¥è¯¢ã€ä¿®æ”¹å’Œåˆ é™¤ä¸ªäººæŒæœ‰çš„åŸºé‡‘ã€‚
-   **æ•°æ®åŒæ­¥**:
    -   å®šæ—¶ä»»åŠ¡æ¯æ—¥è‡ªåŠ¨æ›´æ–°åŸºé‡‘çš„å†å²å‡€å€¼æ•°æ®ã€‚
    -   å®šæ—¶ä»»åŠ¡åœ¨äº¤æ˜“æ—¶æ®µå†…è‡ªåŠ¨æ›´æ–°åŸºé‡‘çš„ç›˜ä¸­å®æ—¶ä¼°å€¼ã€‚
    -   æ”¯æŒæ‰‹åŠ¨è§¦å‘å†å²æ•°æ®åŒæ­¥ã€‚
-   **æ•°æ®å±•ç¤º**: ä»¥ç¾è§‚çš„è¡¨æ ¼å½¢å¼å±•ç¤ºæŒä»“ç»„åˆåŠå…¶é¢„ä¼°ç›ˆäºã€‚
-   **API æœåŠ¡**: åŸºäº FastAPI æä¾›äº†ä¸€å¥— RESTful APIï¼Œæ–¹ä¾¿ä¸å‰ç«¯åº”ç”¨ï¼ˆå¦‚ Nuxt3ï¼‰é›†æˆã€‚
-   **å‘½ä»¤è¡Œå·¥å…·**: åŸºäº Typer æä¾›äº†ä¸€å¥—æ˜“ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ–¹ä¾¿åœ¨ç»ˆç«¯è¿›è¡Œå¿«é€Ÿæ“ä½œã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

-   **å®‰è£… uv**:
    ```bash
    # macOS / Linux
    curl -LsSf https://astral.sh/uv/install.sh | sh
    ```
-   **å®‰è£… PostgreSQL**: ç¡®ä¿æœ¬åœ°æˆ–æœåŠ¡å™¨ä¸Šå·²å®‰è£…å¹¶è¿è¡Œ PostgreSQL æœåŠ¡ã€‚
-   **åˆ›å»ºæ•°æ®åº“**:
    ```sql
    CREATE DATABASE fund_assistant;
    ```

### 2. é¡¹ç›®é…ç½®

-   **å…‹éš†é¡¹ç›®**å¹¶è¿›å…¥ç›®å½•ã€‚
-   **åˆ›å»º `.env` æ–‡ä»¶**: åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º `.env` çš„æ–‡ä»¶ï¼Œå¹¶å¡«å…¥æ‚¨çš„æ•°æ®åº“é…ç½®ä¿¡æ¯ã€‚
    ```dotenv
    # .env
    DATABASE_URL="postgresql://your_user:your_password@localhost:5432/fund_assistant"
    DB_SCHEMA="fund_app"
    ```

### 3. å®‰è£…ä¸è¿è¡Œ

-   **åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ**:
    ```bash
    uv venv
    source .venv/bin/activate
    ```

-   **å®‰è£…é¡¹ç›®ä¾èµ–**:
    ```bash
    uv pip install -e .
    ```

-   **å¯åŠ¨ API æœåŠ¡**:
    ```bash
    uv run uvicorn src.python_cli_starter.main:api_app --reload
    ```
    æœåŠ¡å¯åŠ¨åï¼Œå¯åœ¨ `http://127.0.0.1:8000/docs` æŸ¥çœ‹ API æ–‡æ¡£ã€‚

---

## ğŸ“– ä½¿ç”¨æŒ‡å—

æ‚¨å¯ä»¥é€šè¿‡ **å‘½ä»¤è¡Œ (CLI)** æˆ– **API (curl)** ä¸¤ç§æ–¹å¼ä¸æœ¬åº”ç”¨äº¤äº’ã€‚

### å‘½ä»¤è¡Œ (CLI) ç”¨æ³•

æ‰€æœ‰å‘½ä»¤éƒ½é€šè¿‡ `uv run cli` æ‰§è¡Œï¼Œæ— éœ€æ‰‹åŠ¨æ¿€æ´»è™šæ‹Ÿç¯å¢ƒã€‚

#### **æŸ¥çœ‹æ‰€æœ‰æŒä»“**
ä»¥è¡¨æ ¼å½¢å¼åˆ—å‡ºæ‰€æœ‰æŒä»“åŸºé‡‘åŠå…¶é¢„ä¼°ç›ˆäºã€‚
```bash
uv run cli list-holdings
```

#### **æ·»åŠ æ–°çš„æŒä»“**
```bash
# ç¤ºä¾‹ï¼šæ·»åŠ ä¸€åªåŸºé‡‘ï¼ŒæŒæœ‰é‡‘é¢ä¸º 5000
uv run cli add-holding --code "161725" --amount 5000
```
-   `--code` / `-c`: åŸºé‡‘ä»£ç  (**å¿…å¡«**)
-   `--amount` / `-a`: æŒæœ‰é‡‘é¢ (**å¿…å¡«**)
-   `--name` / `-n`: åŸºé‡‘åç§° (å¯é€‰, ç¨‹åºä¼šè‡ªåŠ¨è·å–)

#### **æ›´æ–°æŒä»“é‡‘é¢**
```bash
# ç¤ºä¾‹ï¼šå°†ä»£ç ä¸º 161725 çš„åŸºé‡‘æŒæœ‰é‡‘é¢æ›´æ–°ä¸º 6500
uv run cli update-holding --code "161725" --amount 6500
```
-   `--code` / `-c`: è¦æ›´æ–°çš„åŸºé‡‘ä»£ç  (**å¿…å¡«**)
-   `--amount` / `-a`: æ–°çš„æŒæœ‰é‡‘é¢ (**å¿…å¡«**)

#### **åˆ é™¤æŒä»“è®°å½•**
æ­¤æ“ä½œä¼šè¿›è¡Œäº¤äº’å¼ç¡®è®¤ï¼Œé˜²æ­¢è¯¯åˆ ã€‚
```bash
# ç¤ºä¾‹ï¼šåˆ é™¤ä»£ç ä¸º 161725 çš„åŸºé‡‘
uv run cli delete-holding 161725
```
> âš ï¸ æ‚¨ç¡®å®šè¦åˆ é™¤åŸºé‡‘ä»£ç ä¸º **161725** çš„æ‰€æœ‰è®°å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼ [y/N]:

å¦‚æœè¦è·³è¿‡ç¡®è®¤ï¼ˆä¾‹å¦‚åœ¨è„šæœ¬ä¸­ä½¿ç”¨ï¼‰ï¼Œå¯ä»¥æ·»åŠ  `--force` æ ‡å¿—ï¼š
```bash
uv run cli delete-holding 161725 --force
```

#### **æ‰‹åŠ¨åŒæ­¥å†å²æ•°æ®**
ç«‹å³è§¦å‘ä¸€æ¬¡æ‰€æœ‰æŒä»“åŸºé‡‘çš„å†å²å‡€å€¼åŒæ­¥ä»»åŠ¡ã€‚
```bash
uv run cli sync-history
```

---

### API (curl) ç”¨æ³•

è¯·ç¡®ä¿ API æœåŠ¡æ­£åœ¨è¿è¡Œ (`uv run uvicorn ...`)ã€‚

#### **GET /holdings/ - æŸ¥è¯¢æ‰€æœ‰æŒä»“**
```bash
curl -X GET "http://127.0.0.1:8000/holdings/"
```

#### **POST /holdings/ - æ·»åŠ æ–°çš„æŒä»“**
```bash
curl -X POST "http://127.0.0.1:8000/holdings/" \
-H "Content-Type: application/json" \
-d '{
    "code": "005827",
    "name": "æ˜“æ–¹è¾¾è“ç­¹ç²¾é€‰",
    "holding_amount": 10000.00
}'
```

#### **GET /holdings/{fund_code}/history - æŸ¥è¯¢å•åªåŸºé‡‘å†å²åŠå‡çº¿**
```bash
curl -X GET "http://127.0.0.1:8000/holdings/005827/history"
```

#### **PUT /holdings/{fund_code} - æ›´æ–°æŒä»“é‡‘é¢**
```bash
curl -X PUT "http://127.0.0.1:8000/holdings/005827" \
-H "Content-Type: application/json" \
-d '{
    "holding_amount": 12500.50
}'
```

#### **DELETE /holdings/{fund_code} - åˆ é™¤æŒä»“è®°å½•**
æˆåŠŸçš„åˆ é™¤è¯·æ±‚å°†è¿”å› `204 No Content` çŠ¶æ€ç ï¼Œæ²¡æœ‰å“åº”ä½“ã€‚ä½¿ç”¨ `-v` å‚æ•°å¯ä»¥æŸ¥çœ‹å“åº”å¤´ä¿¡æ¯ã€‚
```bash
curl -X DELETE "http://127.0.0.1:8000/holdings/005827" -v
```

---

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ src/
â”‚   â””â”€â”€ python_cli_starter/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ cli.py          # CLI å‘½ä»¤å®šä¹‰ (Typer)
â”‚       â”œâ”€â”€ crud.py         # æ•°æ®åº“ CRUD æ“ä½œ (é€‚é… API)
â”‚       â”œâ”€â”€ data_fetcher.py # ä»ç½‘ç»œè·å–æ•°æ®çš„å‡½æ•°
â”‚       â”œâ”€â”€ main.py         # API æœåŠ¡å…¥å£ (FastAPI)
â”‚       â”œâ”€â”€ models.py       # æ•°æ®åº“æ¨¡å‹ (SQLAlchemy)
â”‚       â”œâ”€â”€ schemas.py      # æ•°æ®æ ¡éªŒæ¨¡å‹ (Pydantic)
â”‚       â”œâ”€â”€ services.py     # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å±‚
â”‚       â””â”€â”€ scheduler.py    # å®šæ—¶ä»»åŠ¡é€»è¾‘ (Schedule)
â”œâ”€â”€ .env                    # ç¯å¢ƒå˜é‡ (æœ¬åœ°é…ç½®ï¼Œä¸æäº¤åˆ° git)
â”œâ”€â”€ pyproject.toml          # é¡¹ç›®é…ç½®æ–‡ä»¶ (ä¾èµ–ã€å…ƒæ•°æ®ç­‰)
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

## ğŸ“„ License

MIT